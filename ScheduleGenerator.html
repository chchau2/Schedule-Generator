<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Schedule Generator</title>
  <style>
    table {
      border-collapse: collapse;
      width: 100%;
    }
    td {
      border: 1px solid #000000;
      padding: 10px;
      text-align: center;
      cursor: pointer;
      position: relative; /* For positioning the text box */
    }
    /* might not need this/not sure what it does so garabage [We shoudl probably go over the head stuff later on]
    .text-box {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      display: none;
      width: 80%;
    }
    .text-box input {
      width: 100%;
      padding: 5px;
    }
      */
  </style>
</head>
<body>
    <h1>Staff</h1>
    <input id="chrisHours" placeholder="Chris days off">
    <input id="janiceHours" placeholder="Janice days off">
    <input id="natalieHours" placeholder="Natalie days off">
    <input id="megHours" placeholder="Meg days off">
    <input id="christineHours" placeholder="Christine days off">
    <input id="abrahamHours" placeholder="Abraham days off">
    <input id="vickiHours" placeholder="Vicki days off">
    <button id="generateScheduleButton"> Generate Schedule </button>
    <script src="generateschedule.js"></script>
    <table id="staffTable" border="1">
        <tr>
            <th class='color-cell' style="color: white; background-color: #431843">Chris</th>
            <th class='color-cell' style="color: black; background-color: #74cb60">Janice</th>
            <th class='color-cell' style="color: black; background-color: #9dc4de">Natalie</th>
            <th class='color-cell' style="color: black; background-color: #e3863a">Meg</th>
            <th class='color-cell' style="color: black; background-color: #cb9fd3">Christine</th>
            <th class='color-cell' style="color: white; background-color: #bb2222">Abraham</th>
            <th class='color-cell' style="color: white; background-color: #28356c">Vicki</th>
            <th class='color-cell' style="color: black; background-color: #f3f361">HK</th>
            <th class='color-cell' style="color: black; background-color: white">CLEAR</th>
        </tr>
    </table>
    <h1>Week 1</h1>
    <table id="toggleTable" border="1">
        <tr>
            <th></th>
            <th>Sunday</th>
            <th>Monday</th>
            <th>Tuesday</th>
            <th>Wednesday</th>
            <th>Thursday</th>
            <th>Friday</th>
            <th>Saturday</th>
        </tr>
    </table>
    <script>
        //This assigns the days with their respective numbers
        // Get the current date
        let currentDate = new Date();
        
        // Function to get the start of the current week (Sunday)
        function getStartOfWeek(date) {
            let day = date.getDay(),
                diff = date.getDate() - day; // Get the difference from Sunday
            return new Date(date.setDate(diff));
        }
        
        // Get the start of the current week (Sunday)
        let startOfWeek = getStartOfWeek(new Date(currentDate));
        
        // Define day names and the corresponding date numbers
        const dayNames = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
        const tableHeaders = document.querySelectorAll("#toggleTable th");
        
        // Loop through the days of the week and set day names + date in the headers
        // forEach is an array method which helps iterate over the elements th (table headers) with index starting at 0
        tableHeaders.forEach((th, index) => {
            if (index > 0) { // Skip the first header (empty cell)
                let dayOffset = index - 1; // Index 1 corresponds to Sunday, 2 to Monday, etc.
                let dayDate = new Date(startOfWeek);
                dayDate.setDate(startOfWeek.getDate() + dayOffset); // Calculate the date for the current day
                
                // Create a variable with day name and date
                let dayHeader = `${dayNames[index - 1]} ${dayDate.getDate()}`;
                
                // Update the <th> with the generated variable
                th.textContent = dayHeader; // Insert the variable content into the <th>
            }
        });

    // Generate the table dynamically, meaning we dynamically make the table with cells
    const table = document.getElementById("toggleTable");
    const rows = 7; // Number of rows
    const cols = 8; // Number of columns (14 * 14 = 196 cells)

   
    for (let i = 0; i < rows; i++) {
        const row = table.insertRow(); // Create a new row
        //row.classList.add('empty-cell');
        for (let j = 0; j < cols; j++) 
        {
            const cell = row.insertCell();
            //const cell = row.insertCell(); // Create a new cell
            if (i == 0 && j == 0) cell.textContent = '9am - 5pm';
            if (i == 1 && j == 0) cell.textContent = 'HK';
            if (i == 2 && j == 0) cell.textContent = '1pm - 9pm';
            if (i == 3 && j == 0) cell.textContent = 'MID Shift';
            if (i == 4 && j == 0) cell.textContent = 'NOTES:';
            if (i == 5 && j == 0) cell.textContent = 'Janice';
            if (i == 6 && j == 0) cell.textContent = 'Chris';
            if ((i == 0 || i == 2 || i == 3) && j != 0) cell.classList.add('empty-cell');
            if (i == 1) cell.addEventListener("click", () => {
                    cell.style.backgroundColor = "yellow"; // for Hk, but might not need if they can select the colors above
                });
            if (i > 3) {
                cell.onclick = function(){
                    makeCellEditable(this);
                };
            } else {
                cell.addEventListener("dblclick", function(){
                    makeCellEditable(this);
                });
            }
                
            /* this is probably not needed just keeping it as an example for future use
            if(i < 4){
                cell.addEventListener("click", () => {
                    // Toggle cell background color on click
                    if (cell.style.backgroundColor === "lightblue") {
                    cell.style.backgroundColor = ""; // Reset to default
                    } else {
                    cell.style.backgroundColor = "lightblue"; // Set to light blue
                    }
                });
                
            }
            else{
                cell.onclick = function(){
                    makeCellEditable(this);
                };
            }*/
        } 
    
    } 
    
    function makeCellEditable(cell) {
        if(!cell.isEditable){ cell.contentEditable = true; }      
    }

    let selectedColor = null;
        // Event listener for static color table
    document.getElementById('staffTable').addEventListener('click', function(event) {
        const cell = event.target;
        
        // Check if the clicked cell is a color cell and get its background color
        if (cell.classList.contains('color-cell')) {
            selectedColor = cell.style.backgroundColor;
            console.log("Selected color:", selectedColor); // For debugging
        }
    });

    // Event listener for dynamic table cell clicks (event delegation)
    document.getElementById('toggleTable').addEventListener('click', function(event) {
        const cell = event.target;

        // If the clicked cell is empty, apply the selected color to it
        if (cell.classList.contains('empty-cell') && selectedColor) {
            cell.style.backgroundColor = selectedColor; // Apply selected color to the cell
        }
    });
  </script>
</body>
</html>